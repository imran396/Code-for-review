<?php
/** @noinspection SpellCheckingInspection */

/**
 * Stop words filtering class
 *
 * SAM-6474: Move full-text search query building and queue management logic to \Sam\SearchIndex namespace
 * SAM-1020: Front End - Search Page - Keyword Search Improvements
 *
 * @author        Igors Kotlevskis
 * @version       SVN: $Id: $
 * @since         Mar 01, 2012
 * @copyright     Copyright 2018 by Bidpath, Inc. All rights reserved.
 * File Encoding  UTF-8
 *
 * Bidpath, Inc., 269 Mt. Hermon Road #102, Scotts Valley, CA 95066, USA
 * Phone: ++1 (415) 543 5825, &lt;info@bidpath.com&gt;
 */

namespace Sam\SearchIndex\Helper;

use Sam\Core\Service\CustomizableClass;

/**
 * Class SearchStopWords
 * @package Sam\SearchIndex\Helper
 */
class SearchStopWords extends CustomizableClass
{
    protected const STOP_WORDS = [
        'english' => [
            "a",
            "about",
            "above",
            "above",
            "across",
            "after",
            "afterwards",
            "again",
            "against",
            "all",
            "almost",
            "alone",
            "along",
            "already",
            "also",
            "although",
            "always",
            "am",
            "among",
            "amongst",
            "amoungst",
            "amount",
            "an",
            "and",
            "another",
            "any",
            "anyhow",
            "anyone",
            "anything",
            "anyway",
            "anywhere",
            "are",
            "around",
            "as",
            "at",
            "back",
            "be",
            "became",
            "because",
            "become",
            "becomes",
            "becoming",
            "been",
            "before",
            "beforehand",
            "behind",
            "being",
            "below",
            "beside",
            "besides",
            "between",
            "beyond",
            "bill",
            "both",
            "bottom",
            "but",
            "by",
            "call",
            "can",
            "cannot",
            "cant",
            "co",
            "con",
            "could",
            "couldnt",
            "cry",
            "de",
            "describe",
            "detail",
            "do",
            "done",
            "down",
            "due",
            "during",
            "each",
            "eg",
            "eight",
            "either",
            "eleven",
            "else",
            "elsewhere",
            "empty",
            "enough",
            "etc",
            "even",
            "ever",
            "every",
            "everyone",
            "everything",
            "everywhere",
            "except",
            "few",
            "fifteen",
            "fifty",
            "fill",
            "find",
            "fire",
            "first",
            "five",
            "for",
            "former",
            "formerly",
            "forty",
            "found",
            "four",
            "from",
            "front",
            "full",
            "further",
            "get",
            "give",
            "go",
            "had",
            "has",
            "hasnt",
            "have",
            "he",
            "hence",
            "her",
            "here",
            "hereafter",
            "hereby",
            "herein",
            "hereupon",
            "hers",
            "herself",
            "him",
            "himself",
            "his",
            "how",
            "however",
            "hundred",
            "ie",
            "if",
            "in",
            "inc",
            "indeed",
            "interest",
            "into",
            "is",
            "it",
            "its",
            "itself",
            "keep",
            "last",
            "latter",
            "latterly",
            "least",
            "less",
            "ltd",
            "made",
            "many",
            "may",
            "me",
            "meanwhile",
            "might",
            "mill",
            "mine",
            "more",
            "moreover",
            "most",
            "mostly",
            "move",
            "much",
            "must",
            "my",
            "myself",
            "name",
            "namely",
            "neither",
            "never",
            "nevertheless",
            "next",
            "nine",
            "no",
            "nobody",
            "none",
            "noone",
            "nor",
            "not",
            "nothing",
            "now",
            "nowhere",
            "of",
            "off",
            "often",
            "on",
            "once",
            "one",
            "only",
            "onto",
            "or",
            "other",
            "others",
            "otherwise",
            "our",
            "ours",
            "ourselves",
            "out",
            "over",
            "own",
            "part",
            "per",
            "perhaps",
            "please",
            "put",
            "rather",
            "re",
            "same",
            "see",
            "seem",
            "seemed",
            "seeming",
            "seems",
            "serious",
            "several",
            "she",
            "should",
            "show",
            "side",
            "since",
            "sincere",
            "six",
            "sixty",
            "so",
            "some",
            "somehow",
            "someone",
            "something",
            "sometime",
            "sometimes",
            "somewhere",
            "still",
            "such",
            "system",
            "take",
            "ten",
            "than",
            "that",
            "the",
            "their",
            "them",
            "themselves",
            "then",
            "thence",
            "there",
            "thereafter",
            "thereby",
            "therefore",
            "therein",
            "thereupon",
            "these",
            "they",
            "thickv",
            "thin",
            "third",
            "this",
            "those",
            "though",
            "three",
            "through",
            "throughout",
            "thru",
            "thus",
            "to",
            "together",
            "too",
            "top",
            "toward",
            "towards",
            "twelve",
            "twenty",
            "two",
            "un",
            "under",
            "until",
            "up",
            "upon",
            "us",
            "very",
            "via",
            "was",
            "we",
            "well",
            "were",
            "what",
            "whatever",
            "when",
            "whence",
            "whenever",
            "where",
            "whereafter",
            "whereas",
            "whereby",
            "wherein",
            "whereupon",
            "wherever",
            "whether",
            "which",
            "while",
            "whither",
            "who",
            "whoever",
            "whole",
            "whom",
            "whose",
            "why",
            "will",
            "with",
            "within",
            "without",
            "would",
            "yet",
            "you",
            "your",
            "yours",
            "yourself",
            "yourselves",
            "the"
        ],

        'spanish' => [
            'a',
            'al',
            'algo',
            'algunas',
            'algunos',
            'ante',
            'antes',
            'como',
            'con',
            'contra',
            'cual',
            'cuando',
            'de',
            'del',
            'desde',
            'donde',
            'durante',
            'e',
            'el',
            'ella',
            'ellas',
            'ellos',
            'en',
            'entre',
            'era',
            'erais',
            'eran',
            'eras',
            'eres',
            'es',
            'es',
            'esa',
            'esas',
            'ese',
            'eso',
            'esos',
            'esta',
            'estaba',
            'estaba',
            'estabais',
            'estaban',
            'estabas',
            'estad',
            'estada',
            'estadas',
            'estado',
            'estado',
            'estados',
            'estados',
            'estamos',
            'estamos',
            'estando',
            'estar',
            'estaremos',
            'estará',
            'estarán',
            'estarás',
            'estaré',
            'estaréis',
            'estaría',
            'estaríais',
            'estaríamos',
            'estarían',
            'estarías',
            'estas',
            'este',
            'estemos',
            'esto',
            'estos',
            'estoy',
            'estuve',
            'estuviera',
            'estuvierais',
            'estuvieran',
            'estuvieras',
            'estuvieron',
            'estuviese',
            'estuvieseis',
            'estuviesen',
            'estuvieses',
            'estuvimos',
            'estuviste',
            'estuvisteis',
            'estuviéramos',
            'estuviésemos',
            'estuvo',
            'está',
            'está',
            'estábamos',
            'estáis',
            'están',
            'están',
            'estás',
            'esté',
            'estéis',
            'estén',
            'estés',
            'fue',
            'fue',
            'fuera',
            'fuerais',
            'fueran',
            'fueras',
            'fueron',
            'fueron',
            'fuese',
            'fueseis',
            'fuesen',
            'fueses',
            'fui',
            'fuimos',
            'fuiste',
            'fuisteis',
            'fuéramos',
            'fuésemos',
            'ha',
            'ha',
            'haber',
            'habida',
            'habidas',
            'habido',
            'habidos',
            'habiendo',
            'habremos',
            'habrá',
            'habrán',
            'habrás',
            'habré',
            'habréis',
            'habría',
            'habríais',
            'habríamos',
            'habrían',
            'habrías',
            'habéis',
            'había',
            'había',
            'habíais',
            'habíamos',
            'habían',
            'habías',
            'han',
            'han',
            'has',
            'hasta',
            'hay',
            'haya',
            'hayamos',
            'hayan',
            'hayas',
            'hayáis',
            'he',
            'hemos',
            'hube',
            'hubiera',
            'hubierais',
            'hubieran',
            'hubieras',
            'hubieron',
            'hubiese',
            'hubieseis',
            'hubiesen',
            'hubieses',
            'hubimos',
            'hubiste',
            'hubisteis',
            'hubiéramos',
            'hubiésemos',
            'hubo',
            'la',
            'las',
            'le',
            'les',
            'lo',
            'los',
            'me',
            'mi',
            'mis',
            'mucho',
            'muchos',
            'muy',
            'más',
            'mí',
            'mía',
            'mías',
            'mío',
            'míos',
            'nada',
            'ni',
            'no',
            'nos',
            'nosotras',
            'nosotros',
            'nuestra',
            'nuestras',
            'nuestro',
            'nuestros',
            'o',
            'os',
            'otra',
            'otras',
            'otro',
            'otros',
            'para',
            'pero',
            'poco',
            'por',
            'porque',
            'que',
            'quien',
            'quienes',
            'qué',
            'se',
            'sea',
            'sea',
            'seamos',
            'sean',
            'seas',
            'ser',
            'seremos',
            'será',
            'serán',
            'serás',
            'seré',
            'seréis',
            'sería',
            'seríais',
            'seríamos',
            'serían',
            'serías',
            'seáis',
            'sido',
            'siendo',
            'sin',
            'sobre',
            'sois',
            'somos',
            'son',
            'son',
            'soy',
            'su',
            'sus',
            'suya',
            'suyas',
            'suyo',
            'suyos',
            'sí',
            'también',
            'tanto',
            'te',
            'tendremos',
            'tendrá',
            'tendrán',
            'tendrás',
            'tendré',
            'tendréis',
            'tendría',
            'tendríais',
            'tendríamos',
            'tendrían',
            'tendrías',
            'tened',
            'tenemos',
            'tenga',
            'tengamos',
            'tengan',
            'tengas',
            'tengo',
            'tengáis',
            'tenida',
            'tenidas',
            'tenido',
            'tenidos',
            'teniendo',
            'tenéis',
            'tenía',
            'teníais',
            'teníamos',
            'tenían',
            'tenías',
            'ti',
            'tiene',
            'tiene',
            'tienen',
            'tienes',
            'todo',
            'todos',
            'tu',
            'tus',
            'tuve',
            'tuviera',
            'tuvierais',
            'tuvieran',
            'tuvieras',
            'tuvieron',
            'tuviese',
            'tuvieseis',
            'tuviesen',
            'tuvieses',
            'tuvimos',
            'tuviste',
            'tuvisteis',
            'tuviéramos',
            'tuviésemos',
            'tuvo',
            'tuya',
            'tuyas',
            'tuyo',
            'tuyos',
            'tú',
            'un',
            'una',
            'uno',
            'unos',
            'vosotras',
            'vosotros',
            'vuestra',
            'vuestras',
            'vuestro',
            'vuestros',
            'y',
            'ya',
            'yo',
            'él',
            'éramos'
        ],

        'french' => [
            'a',
            'ao',
            'aos',
            'aquela',
            'aquelas',
            'aquele',
            'aqueles',
            'aquilo',
            'as',
            'até',
            'com',
            'como',
            'da',
            'das',
            'de',
            'dela',
            'delas',
            'dele',
            'deles',
            'depois',
            'do',
            'dos',
            'e',
            'ela',
            'elas',
            'ele',
            'eles',
            'em',
            'entre',
            'era',
            'era',
            'eram',
            'essa',
            'essas',
            'esse',
            'esses',
            'esta',
            'estamos',
            'estas',
            'estava',
            'estavam',
            'este',
            'esteja',
            'estejam',
            'estejamos',
            'estes',
            'esteve',
            'estive',
            'estivemos',
            'estiver',
            'estivera',
            'estiveram',
            'estiverem',
            'estivermos',
            'estivesse',
            'estivessem',
            'estivéramos',
            'estivéssemos',
            'estou',
            'está',
            'está',
            'estávamos',
            'estão',
            'estão',
            'eu',
            'foi',
            'foi',
            'fomos',
            'for',
            'fora',
            'foram',
            'foram',
            'forem',
            'formos',
            'fosse',
            'fosse',
            'fossem',
            'fui',
            'fôramos',
            'fôssemos',
            'haja',
            'hajam',
            'hajamos',
            'havemos',
            'havia',
            'hei',
            'houve',
            'houvemos',
            'houver',
            'houvera',
            'houveram',
            'houverei',
            'houverem',
            'houveremos',
            'houveria',
            'houveriam',
            'houvermos',
            'houverá',
            'houverão',
            'houveríamos',
            'houvesse',
            'houvessem',
            'houvéramos',
            'houvéssemos',
            'há',
            'há',
            'hão',
            'isso',
            'isto',
            'já',
            'lhe',
            'lhes',
            'mais',
            'mas',
            'me',
            'mesmo',
            'meu',
            'meus',
            'minha',
            'minhas',
            'muito',
            'na',
            'nas',
            'nem',
            'no',
            'nos',
            'nossa',
            'nossas',
            'nosso',
            'nossos',
            'num',
            'numa',
            'não',
            'nós',
            'o',
            'os',
            'ou',
            'para',
            'pela',
            'pelas',
            'pelo',
            'pelos',
            'por',
            'qual',
            'quando',
            'que',
            'quem',
            'se',
            'seja',
            'seja',
            'sejam',
            'sejamos',
            'sem',
            'ser',
            'serei',
            'seremos',
            'seria',
            'seriam',
            'será',
            'será',
            'serão',
            'seríamos',
            'seu',
            'seus',
            'somos',
            'sou',
            'sua',
            'suas',
            'são',
            'só',
            'também',
            'te',
            'tem',
            'tem',
            'temos',
            'tenha',
            'tenham',
            'tenhamos',
            'tenho',
            'tenho',
            'ter',
            'terei',
            'teremos',
            'teria',
            'teriam',
            'terá',
            'terão',
            'teríamos',
            'teu',
            'teus',
            'teve',
            'tinha',
            'tinha',
            'tinham',
            'tive',
            'tivemos',
            'tiver',
            'tivera',
            'tiveram',
            'tiverem',
            'tivermos',
            'tivesse',
            'tivessem',
            'tivéramos',
            'tivéssemos',
            'tu',
            'tua',
            'tuas',
            'tém',
            'têm',
            'tínhamos',
            'um',
            'uma',
            'você',
            'vocês',
            'vos',
            'à',
            'às',
            'é',
            'éramos'
        ],

        'german' => [
            'aber',
            'alle',
            'allem',
            'allen',
            'aller',
            'alles',
            'als',
            'also',
            'am',
            'an',
            'ander',
            'andere',
            'anderem',
            'anderen',
            'anderer',
            'anderes',
            'anderm',
            'andern',
            'anderr',
            'anders',
            'auch',
            'auf',
            'aus',
            'bei',
            'bin',
            'bis',
            'bist',
            'da',
            'damit',
            'dann',
            'das',
            'dasselbe',
            'dazu',
            'daß',
            'dein',
            'deine',
            'deinem',
            'deinen',
            'deiner',
            'deines',
            'dem',
            'demselben',
            'den',
            'denn',
            'denselben',
            'der',
            'derer',
            'derselbe',
            'derselben',
            'des',
            'desselben',
            'dessen',
            'dich',
            'die',
            'dies',
            'diese',
            'dieselbe',
            'dieselben',
            'diesem',
            'diesen',
            'dieser',
            'dieses',
            'dir',
            'doch',
            'dort',
            'du',
            'durch',
            'ein',
            'eine',
            'einem',
            'einen',
            'einer',
            'eines',
            'einig',
            'einige',
            'einigem',
            'einigen',
            'einiger',
            'einiges',
            'einmal',
            'er',
            'es',
            'etwas',
            'euch',
            'euer',
            'eure',
            'eurem',
            'euren',
            'eurer',
            'eures',
            'für',
            'gegen',
            'gewesen',
            'hab',
            'habe',
            'haben',
            'hat',
            'hatte',
            'hatten',
            'hier',
            'hin',
            'hinter',
            'ich',
            'ihm',
            'ihn',
            'ihnen',
            'ihr',
            'ihre',
            'ihrem',
            'ihren',
            'ihrer',
            'ihres',
            'im',
            'in',
            'indem',
            'ins',
            'ist',
            'jede',
            'jedem',
            'jeden',
            'jeder',
            'jedes',
            'jene',
            'jenem',
            'jenen',
            'jener',
            'jenes',
            'jetzt',
            'kann',
            'kein',
            'keine',
            'keinem',
            'keinen',
            'keiner',
            'keines',
            'können',
            'könnte',
            'machen',
            'man',
            'manche',
            'manchem',
            'manchen',
            'mancher',
            'manches',
            'mein',
            'meine',
            'meinem',
            'meinen',
            'meiner',
            'meines',
            'mich',
            'mir',
            'mit',
            'muss',
            'musste',
            'nach',
            'nicht',
            'nichts',
            'noch',
            'nun',
            'nur',
            'ob',
            'oder',
            'ohne',
            'sehr',
            'sein',
            'seine',
            'seinem',
            'seinen',
            'seiner',
            'seines',
            'selbst',
            'sich',
            'sie',
            'sind',
            'so',
            'solche',
            'solchem',
            'solchen',
            'solcher',
            'solches',
            'soll',
            'sollte',
            'sondern',
            'sonst',
            'um',
            'und',
            'uns',
            'unse',
            'unsem',
            'unsen',
            'unser',
            'unses',
            'unter',
            'viel',
            'vom',
            'von',
            'vor',
            'war',
            'waren',
            'warst',
            'was',
            'weg',
            'weil',
            'weiter',
            'welche',
            'welchem',
            'welchen',
            'welcher',
            'welches',
            'wenn',
            'werde',
            'werden',
            'wie',
            'wieder',
            'will',
            'wir',
            'wird',
            'wirst',
            'wo',
            'wollen',
            'wollte',
            'während',
            'würde',
            'würden',
            'zu',
            'zum',
            'zur',
            'zwar',
            'zwischen',
            'über'
        ],

        'portuguese' => [
            'a',
            'ao',
            'aos',
            'aquela',
            'aquelas',
            'aquele',
            'aqueles',
            'aquilo',
            'as',
            'até',
            'com',
            'como',
            'da',
            'das',
            'de',
            'dela',
            'delas',
            'dele',
            'deles',
            'depois',
            'do',
            'dos',
            'e',
            'ela',
            'elas',
            'ele',
            'eles',
            'em',
            'entre',
            'era',
            'era',
            'eram',
            'essa',
            'essas',
            'esse',
            'esses',
            'esta',
            'estamos',
            'estas',
            'estava',
            'estavam',
            'este',
            'esteja',
            'estejam',
            'estejamos',
            'estes',
            'esteve',
            'estive',
            'estivemos',
            'estiver',
            'estivera',
            'estiveram',
            'estiverem',
            'estivermos',
            'estivesse',
            'estivessem',
            'estivéramos',
            'estivéssemos',
            'estou',
            'está',
            'está',
            'estávamos',
            'estão',
            'estão',
            'eu',
            'foi',
            'foi',
            'fomos',
            'for',
            'fora',
            'foram',
            'foram',
            'forem',
            'formos',
            'fosse',
            'fosse',
            'fossem',
            'fui',
            'fôramos',
            'fôssemos',
            'haja',
            'hajam',
            'hajamos',
            'havemos',
            'havia',
            'hei',
            'houve',
            'houvemos',
            'houver',
            'houvera',
            'houveram',
            'houverei',
            'houverem',
            'houveremos',
            'houveria',
            'houveriam',
            'houvermos',
            'houverá',
            'houverão',
            'houveríamos',
            'houvesse',
            'houvessem',
            'houvéramos',
            'houvéssemos',
            'há',
            'há',
            'hão',
            'isso',
            'isto',
            'já',
            'lhe',
            'lhes',
            'mais',
            'mas',
            'me',
            'mesmo',
            'meu',
            'meus',
            'minha',
            'minhas',
            'muito',
            'na',
            'nas',
            'nem',
            'no',
            'nos',
            'nossa',
            'nossas',
            'nosso',
            'nossos',
            'num',
            'numa',
            'não',
            'nós',
            'o',
            'os',
            'ou',
            'para',
            'pela',
            'pelas',
            'pelo',
            'pelos',
            'por',
            'qual',
            'quando',
            'que',
            'quem',
            'se',
            'seja',
            'seja',
            'sejam',
            'sejamos',
            'sem',
            'ser',
            'serei',
            'seremos',
            'seria',
            'seriam',
            'será',
            'será',
            'serão',
            'seríamos',
            'seu',
            'seus',
            'somos',
            'sou',
            'sua',
            'suas',
            'são',
            'só',
            'também',
            'te',
            'tem',
            'tem',
            'temos',
            'tenha',
            'tenham',
            'tenhamos',
            'tenho',
            'tenho',
            'ter',
            'terei',
            'teremos',
            'teria',
            'teriam',
            'terá',
            'terão',
            'teríamos',
            'teu',
            'teus',
            'teve',
            'tinha',
            'tinha',
            'tinham',
            'tive',
            'tivemos',
            'tiver',
            'tivera',
            'tiveram',
            'tiverem',
            'tivermos',
            'tivesse',
            'tivessem',
            'tivéramos',
            'tivéssemos',
            'tu',
            'tua',
            'tuas',
            'tém',
            'têm',
            'tínhamos',
            'um',
            'uma',
            'você',
            'vocês',
            'vos',
            'à',
            'às',
            'é',
            'éramos'
        ],
    ];

    /**
     * @return static
     */
    public static function new(): static
    {
        return self::_new(self::class);
    }

    /**
     * @param string $text
     * @param string $lang
     * @return string
     */
    public function filter(string $text, string $lang = 'english'): string
    {
        if (isset(self::STOP_WORDS[$lang])) {
            $text = ' ' . mb_strtolower($text) . ' ';
            foreach (self::STOP_WORDS[$lang] as $stopWord) {
                $text = preg_replace('/([^\p{L}\p{N}]+)' . $stopWord . '([^\p{L}\p{N}]+)/mu', '$1$2', $text);
            }
            $text = preg_replace('/\s+/mu', ' ', $text);
        }
        return $text;
    }
}
